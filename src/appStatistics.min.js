const config={url:"http://log.ktj.wankacn.com"};var CryptoJS=CryptoJS||function(e,t){var r={},i=r.lib={},n=function(){},s=i.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var n=0;n<e;n++)t[i+n>>>2]|=(r[n>>>2]>>>24-n%4*8&255)<<24-(i+n)%4*8;else if(65535<r.length)for(n=0;n<e;n+=4)t[i+n>>>2]=r[n>>>2];else t.push.apply(t,r);return this.sigBytes+=e,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r=[],i=0;i<t;i+=4)r.push(4294967296*e.random()|0);return new a.init(r,t)}}),o=r.enc={},c=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],i=0;i<e;i++){var n=t[i>>>2]>>>24-i%4*8&255;r.push((n>>>4).toString(16)),r.push((15&n).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i+=2)r[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new a.init(r,t/2)}},u=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],i=0;i<e;i++)r.push(String.fromCharCode(t[i>>>2]>>>24-i%4*8&255));return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new a.init(r,t)}},h=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},p=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,i=r.words,n=r.sigBytes,s=this.blockSize,o=n/(4*s);if(t=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*s,n=e.min(4*t,n),t){for(var c=0;c<t;c+=s)this._doProcessBlock(i,c);c=i.splice(0,t),r.sigBytes-=n}return new a.init(c,n)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=p.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new _.HMAC.init(e,r).finalize(t)}}});var _=r.algo={};return r}(Math);!function(){var e=CryptoJS,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,i=this._map;e.clamp(),e=[];for(var n=0;n<r;n+=3)for(var s=(t[n>>>2]>>>24-n%4*8&255)<<16|(t[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|t[n+2>>>2]>>>24-(n+2)%4*8&255,a=0;4>a&&n+.75*a<r;a++)e.push(i.charAt(s>>>6*(3-a)&63));if(t=i.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var r=e.length,i=this._map;(n=i.charAt(64))&&(-1!=(n=e.indexOf(n))&&(r=n));for(var n=[],s=0,a=0;a<r;a++)if(a%4){var o=i.indexOf(e.charAt(a-1))<<a%4*2,c=i.indexOf(e.charAt(a))>>>6-a%4*2;n[s>>>2]|=(o|c)<<24-s%4*8,s++}return t.create(n,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,r,i,n,s,a){return((e=e+(t&r|~t&i)+n+a)<<s|e>>>32-s)+t}function r(e,t,r,i,n,s,a){return((e=e+(t&i|r&~i)+n+a)<<s|e>>>32-s)+t}function i(e,t,r,i,n,s,a){return((e=e+(t^r^i)+n+a)<<s|e>>>32-s)+t}function n(e,t,r,i,n,s,a){return((e=e+(r^(t|~i))+n+a)<<s|e>>>32-s)+t}for(var s=CryptoJS,a=(c=s.lib).WordArray,o=c.Hasher,c=s.algo,u=[],h=0;64>h;h++)u[h]=4294967296*e.abs(e.sin(h+1))|0;c=c.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,s){for(var a=0;16>a;a++){var o=e[p=s+a];e[p]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}a=this._hash.words;var c,h,p=e[s+0],_=(o=e[s+1],e[s+2]),f=e[s+3],d=e[s+4],l=e[s+5],g=e[s+6],m=e[s+7],y=e[s+8],v=e[s+9],k=e[s+10],S=e[s+11],b=e[s+12],w=e[s+13],B=e[s+14],x=e[s+15],C=a[0],P=n(P=n(P=n(P=n(P=i(P=i(P=i(P=i(P=r(P=r(P=r(P=r(P=t(P=t(P=t(P=t(P=a[1],h=t(h=a[2],c=t(c=a[3],C=t(C,P,h,c,p,7,u[0]),P,h,o,12,u[1]),C,P,_,17,u[2]),c,C,f,22,u[3]),h=t(h,c=t(c,C=t(C,P,h,c,d,7,u[4]),P,h,l,12,u[5]),C,P,g,17,u[6]),c,C,m,22,u[7]),h=t(h,c=t(c,C=t(C,P,h,c,y,7,u[8]),P,h,v,12,u[9]),C,P,k,17,u[10]),c,C,S,22,u[11]),h=t(h,c=t(c,C=t(C,P,h,c,b,7,u[12]),P,h,w,12,u[13]),C,P,B,17,u[14]),c,C,x,22,u[15]),h=r(h,c=r(c,C=r(C,P,h,c,o,5,u[16]),P,h,g,9,u[17]),C,P,S,14,u[18]),c,C,p,20,u[19]),h=r(h,c=r(c,C=r(C,P,h,c,l,5,u[20]),P,h,k,9,u[21]),C,P,x,14,u[22]),c,C,d,20,u[23]),h=r(h,c=r(c,C=r(C,P,h,c,v,5,u[24]),P,h,B,9,u[25]),C,P,f,14,u[26]),c,C,y,20,u[27]),h=r(h,c=r(c,C=r(C,P,h,c,w,5,u[28]),P,h,_,9,u[29]),C,P,m,14,u[30]),c,C,b,20,u[31]),h=i(h,c=i(c,C=i(C,P,h,c,l,4,u[32]),P,h,y,11,u[33]),C,P,S,16,u[34]),c,C,B,23,u[35]),h=i(h,c=i(c,C=i(C,P,h,c,o,4,u[36]),P,h,d,11,u[37]),C,P,m,16,u[38]),c,C,k,23,u[39]),h=i(h,c=i(c,C=i(C,P,h,c,w,4,u[40]),P,h,p,11,u[41]),C,P,f,16,u[42]),c,C,g,23,u[43]),h=i(h,c=i(c,C=i(C,P,h,c,v,4,u[44]),P,h,b,11,u[45]),C,P,x,16,u[46]),c,C,_,23,u[47]),h=n(h,c=n(c,C=n(C,P,h,c,p,6,u[48]),P,h,m,10,u[49]),C,P,B,15,u[50]),c,C,l,21,u[51]),h=n(h,c=n(c,C=n(C,P,h,c,b,6,u[52]),P,h,f,10,u[53]),C,P,k,15,u[54]),c,C,o,21,u[55]),h=n(h,c=n(c,C=n(C,P,h,c,y,6,u[56]),P,h,x,10,u[57]),C,P,g,15,u[58]),c,C,w,21,u[59]),h=n(h,c=n(c,C=n(C,P,h,c,d,6,u[60]),P,h,S,10,u[61]),C,P,_,15,u[62]),c,C,v,21,u[63]);a[0]=a[0]+C|0,a[1]=a[1]+P|0,a[2]=a[2]+h|0,a[3]=a[3]+c|0},_doFinalize:function(){var t=this._data,r=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;r[n>>>5]|=128<<24-n%32;var s=e.floor(i/4294967296);for(r[15+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),r[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(r.length+1),this._process(),r=(t=this._hash).words,i=0;4>i;i++)n=r[i],r[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),s.MD5=o._createHelper(c),s.HmacMD5=o._createHmacHelper(c)}(Math),function(){var e,t=CryptoJS,r=(e=t.lib).Base,i=e.WordArray,n=(e=t.algo).EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=(o=this.cfg).hasher.create(),n=i.create(),s=n.words,a=o.keySize,o=o.iterations;s.length<a;){c&&r.update(c);var c=r.update(e).finalize(t);r.reset();for(var u=1;u<o;u++)c=r.finalize(c),r.reset();n.concat(c)}return n.sigBytes=4*a,n}});t.EvpKDF=function(e,t,r){return n.create(r).compute(e,t)}}(),CryptoJS.lib.Cipher||function(e){var t=(f=CryptoJS).lib,r=t.Base,i=t.WordArray,n=t.BufferedBlockAlgorithm,s=f.enc.Base64,a=f.algo.EvpKDF,o=t.Cipher=n.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,r,i){return("string"==typeof r?d:_).encrypt(e,t,r,i)},decrypt:function(t,r,i){return("string"==typeof r?d:_).decrypt(e,t,r,i)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=f.mode={},u=function(e,t,r){var i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(var n=0;n<r;n++)e[t+n]^=i[n]},h=(t.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();h.Encryptor=h.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;u.call(this,e,t,i),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),h.Decryptor=h.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,n=e.slice(t,t+i);r.decryptBlock(e,t),u.call(this,e,t,i),this._prevBlock=n}}),c=c.CBC=h,h=(f.pad={}).Pkcs7={pad:function(e,t){for(var r,n=(r=(r=4*t)-e.sigBytes%r)<<24|r<<16|r<<8|r,s=[],a=0;a<r;a+=4)s.push(n);r=i.create(s,r),e.concat(r)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:c,padding:h}),reset:function(){o.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=t.createEncryptor;else r=t.createDecryptor,this._minBufferSize=1;this._mode=r.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),_=(c=(f.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?i.create([1398893684,1701076831]).concat(e).concat(t):t).toString(s)},parse:function(e){var t=(e=s.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var r=i.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:r})}},t.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(e,t,r,i){i=this.cfg.extend(i);var n=e.createEncryptor(r,i);return t=n.finalize(t),n=n.cfg,p.create({ciphertext:t,key:r,iv:n.iv,algorithm:e,mode:n.mode,padding:n.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,r,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(r,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),f=(f.kdf={}).OpenSSL={execute:function(e,t,r,n){return n||(n=i.random(8)),e=a.create({keySize:t+r}).compute(e,n),r=i.create(e.words.slice(t),4*r),e.sigBytes=4*t,p.create({key:e,iv:r,salt:n})}},d=t.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:f}),encrypt:function(e,t,r,i){return r=(i=this.cfg.extend(i)).kdf.execute(r,e.keySize,e.ivSize),i.iv=r.iv,(e=_.encrypt.call(this,e,t,r.key,i)).mixIn(r),e},decrypt:function(e,t,r,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),r=i.kdf.execute(r,e.keySize,e.ivSize,t.salt),i.iv=r.iv,_.decrypt.call(this,e,t,r.key,i)}})}(),function(){for(var e=CryptoJS,t=e.lib.BlockCipher,r=e.algo,i=[],n=[],s=[],a=[],o=[],c=[],u=[],h=[],p=[],_=[],f=[],d=0;256>d;d++)f[d]=128>d?d<<1:d<<1^283;var l=0,g=0;for(d=0;256>d;d++){var m=(m=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&m^99;i[l]=m,n[m]=l;var y=f[l],v=f[y],k=f[v],S=257*f[m]^16843008*m;s[l]=S<<24|S>>>8,a[l]=S<<16|S>>>16,o[l]=S<<8|S>>>24,c[l]=S,S=16843009*k^65537*v^257*y^16843008*l,u[m]=S<<24|S>>>8,h[m]=S<<16|S>>>16,p[m]=S<<8|S>>>24,_[m]=S,l?(l=y^f[f[f[k^y]]],g^=f[f[g]]):l=g=1}var b=[0,1,2,4,8,16,32,64,128,27,54];r=r.AES=t.extend({_doReset:function(){for(var e=(r=this._key).words,t=r.sigBytes/4,r=4*((this._nRounds=t+6)+1),n=this._keySchedule=[],s=0;s<r;s++)if(s<t)n[s]=e[s];else{var a=n[s-1];s%t?6<t&&4==s%t&&(a=i[a>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[255&a]):(a=i[(a=a<<8|a>>>24)>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[255&a],a^=b[s/t|0]<<24),n[s]=n[s-t]^a}for(e=this._invKeySchedule=[],t=0;t<r;t++)s=r-t,a=t%4?n[s]:n[s-4],e[t]=4>t||4>=s?a:u[i[a>>>24]]^h[i[a>>>16&255]]^p[i[a>>>8&255]]^_[i[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,o,c,i)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,u,h,p,_,n),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,i,n,s,a,o){for(var c=this._nRounds,u=e[t]^r[0],h=e[t+1]^r[1],p=e[t+2]^r[2],_=e[t+3]^r[3],f=4,d=1;d<c;d++){var l=i[u>>>24]^n[h>>>16&255]^s[p>>>8&255]^a[255&_]^r[f++],g=i[h>>>24]^n[p>>>16&255]^s[_>>>8&255]^a[255&u]^r[f++],m=i[p>>>24]^n[_>>>16&255]^s[u>>>8&255]^a[255&h]^r[f++];_=i[_>>>24]^n[u>>>16&255]^s[h>>>8&255]^a[255&p]^r[f++],u=l,h=g,p=m}l=(o[u>>>24]<<24|o[h>>>16&255]<<16|o[p>>>8&255]<<8|o[255&_])^r[f++],g=(o[h>>>24]<<24|o[p>>>16&255]<<16|o[_>>>8&255]<<8|o[255&u])^r[f++],m=(o[p>>>24]<<24|o[_>>>16&255]<<16|o[u>>>8&255]<<8|o[255&h])^r[f++],_=(o[_>>>24]<<24|o[u>>>16&255]<<16|o[h>>>8&255]<<8|o[255&p])^r[f++],e[t]=l,e[t+1]=g,e[t+2]=m,e[t+3]=_},keySize:8});e.AES=t._createHelper(r)}(),CryptoJS.pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){for(var t=e.words,r=e.sigBytes-1;!(t[r>>>2]>>>24-r%4*8&255);)r--;e.sigBytes=r+1}};import storage from"@system.storage";import nativeFetch from"@system.fetch";import device from"@system.device";import network from"@system.network";import account from"@service.account";import shortcut from"@system.shortcut";import md5 from"md5";import app from"@system.app";import router from"@system.router";import APP_CONFIG from"./statistics.config";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.APP_STATISTICS=t()}(this,function(){"use strict";function e(e){let t="";for(let r in e)t+=r+"="+e[r]+"&";return t=t.substring(0,t.length-1)}function t(e){return"string"==typeof e?e:JSON.stringify(e)}function r(e,t){let r=md5("huanju@quickapp"+t).substring(16).toLowerCase(),i=CryptoJS.enc.Latin1.parse(r),n=CryptoJS.enc.Latin1.parse("2018080716102000");return CryptoJS.AES.encrypt(e,i,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.ZeroPadding}).toString()}function i(){return(268435456*(1+Math.random())|0).toString(16)}function n(e){let t=Date.now()+i()+i()+(e||i());return md5(t)}function s(e){let t=/^[0-9a-zA-Z_\u4e00-\u9fa5]{0,255}$/,r=0;if("string"==typeof e&&t.test(e))return!0;if(function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e)){for(let i in e){let n=e[i];if("string"!=typeof i&&"number"!=typeof i||!/^[0-9a-zA-Z_\u4e00-\u9fa5]{1,255}$/.test(i))return!1;if("string"!=typeof n&&"number"!=typeof n||!t.test(n))return!1;r++}return!(r>100)}return!1}const a={get:function(e){let{url:t,timeout:r}=e,i=new Promise((e,r)=>{try{nativeFetch.fetch({url:config.url+t,success:function(t){e(t)},fail:function(t,r){e(t)}})}catch(e){}}),n=new Promise((e,t)=>{setTimeout(()=>{e({code:204,massage:"Request timed out"})},r||3e3)});return Promise.race([n,i])}};function o(e){return a.get({url:"/a.gif?"+e})}function c(...e){return new Promise((t,r)=>{try{storage.set({key:e[0],value:e[1]||"",success:function(e){t(!0)},fail:function(e){t(!1)}})}catch(e){t(!1)}})}function u(e){return new Promise((t,r)=>{try{storage.get({key:e,success:function(e){t(e)},fail:function(e,r){t(!1)}})}catch(e){t(!1)}})}const h={deviceIds:()=>new Promise((e,t)=>{try{device.getId({type:["device","mac"],success:function(t){e(t)},fail:function(t,r){e({})}})}catch(t){e({})}}),getUserId:()=>new Promise((e,t)=>{try{device.getUserId({success:function(t){e(t)},fail:function(t,r){e({})}})}catch(t){e({})}}),deviceInfos:()=>new Promise((e,t)=>{try{device.getInfo({success:function(t){e(t)},fail:function(){e({})}})}catch(t){e({})}}),netType:()=>new Promise((e,t)=>{try{network.getType({success:function(t){e(t)},fail:function(){e({})}})}catch(t){e({})}}),has_shortcut:()=>new Promise((e,t)=>{try{shortcut.hasInstalled({success:function(t){e({has_icon:t?1:0})},fail:function(){e({has_icon:0})}})}catch(t){e({has_icon:0})}})},p={sdk_version:"1.3.2.2",debug:0},_="_SD_BD_CUID_",f="_SD_BD_ERR_MSG_INFO_",d=3e4,l={has_init:!1,has_cuid_storage:!1,has_open_log:!1};const g={device:(e,i)=>({package:e.package||"",channel:e.channel||"",name:e.name||"",svr:e.versionName||"",client_id:r(e.device||"",i),info_ma:r(e.mac||"",i),os_id:r(e.userId||"",i),make:(e.brand||"").toLowerCase(),manufacturer:(e.manufacturer||"").toLowerCase(),model:(e.model||"").toLowerCase(),product:(e.product||"").toLowerCase(),os_type:e.osType||"",ovr:e.osVersionName||"",pla_ver:e.platformVersionName||"",lan:(e.language||"").toLowerCase(),region:(e.region||"").toLowerCase(),px:`${e.screenWidth||""}*${e.screenHeight||""}`,net:e.type||"",has_icon:e.has_icon||0,source:e.source||"",extra:t(e.extra||"")}),page:(e={})=>Object.assign({page_name:"",page_path:"",sta_time:"",end_time:"",duration:"",is_entry:0},e),public:e=>({app_id:APP_CONFIG.app_key||"",cuid:e.cuid||"",req_id:e.req||"",en_code:"cuid",action:2})},m=new class{constructor(){this.state={is_entry:1,cuid:"",req:"",log_list:[],data:null,page:null},this.init=this.init.bind(this),this.page_stat=this.page_stat.bind(this),this.page_end=this.page_end.bind(this),this.merge_datas=this.merge_datas.bind(this),this.save_to_queue=this.save_to_queue.bind(this),this.handle_submit=this.handle_submit.bind(this),this.send_queue=this.send_queue.bind(this),this.event_log=this.event_log.bind(this),this.err_report=this.err_report.bind(this),this.isReStart=this.isReStart.bind(this),this.reStart=this.reStart.bind(this),this.get_app_info=this.get_app_info.bind(this),this.combine_err_data=this.combine_err_data.bind(this)}init(e){l.has_init=!0;let r={},s=e||{_def:{}};s._def=s._def||{manifest:{}};let a,{_def:{manifest:o}}=s;try{a=app.getInfo()}catch(e){let r={err_msg:t(e.stack)||"",err_site:"app.getInfo"};m.err_report(r)}r.package=o.package||a.packageName,r.versionName=o.versionName||a.versionName,r.minPlatformVersion=o.minPlatformVersion||"",r.name=o.name||a.name,r.source=a.source&&a.source.type,r.extra=a.source&&a.source.extra;try{r.channel=account.getProvider()}catch(e){let r={err_msg:t(e.stack)||"",err_site:"account.getProvider"};m.err_report(r)}Promise.all([h.deviceInfos(),h.getUserId(),h.netType(),h.has_shortcut()]).then(e=>{let t=Object.assign(r,...e),s={};u(_).then(e=>{e?s.cuid=e:(s.cuid=function(e){let t=e||i();return md5(Date.now()+"-"+i()+"-"+i()+"-"+i()+"-"+t)}(t.userId||""),c(_,s.cuid).then(e=>{e&&(l.has_cuid_storage=!0)})),this.state.cuid=s.cuid,s.req=this.state.req=n(s.cuid),this.state.data=Object.assign({},g.device(t,this.state.cuid),g.public(s))})})}get_app_info(e){let r={},i={};try{i=app.getInfo()}catch(e){let r={err_msg:t(e.stack)||"",err_site:"app.getInfo"};m.err_report(r)}r.package=i.packageName,r.versionName=i.versionName,r.name=i.name,r.source=i.source&&i.source.type,r.extra=i.source&&i.source.extra;try{r.channel=account.getProvider()}catch(e){let r={err_msg:t(e.stack)||"",err_site:"account.getProvider"};m.err_report(r)}h.deviceInfos().then(t=>{r=Object.assign(r,t);let i=Object.assign({},g.device(r,this.state.cuid),g.public({}));e&&e(i)})}page_stat(e){let r,i,n;try{i=(r=router.getState()||{}).name,n=r.path}catch(e){let r={err_msg:t(e.stack)||"",err_site:"router.getState"};m.err_report(r)}try{this.isReStart(i)&&this.reStart()}catch(e){let r={err_msg:t(e.stack)||"",err_site:"computed reStart"};m.err_report(r)}this.state.page=g.page({sta_time:Date.now(),page_name:i||"",page_path:n||"",is_entry:this.state.is_entry||0}),this.state.is_entry=0,l.has_open_log=!0}page_end(e){if(!this.state.cuid||!this.state.data)return;let t=Date.now();if(this.state.page)this.state.page.duration=t-this.state.page.sta_time,this.state.page.end_time=t,this.handle_submit();else{let e={err_msg:`this.state.page is ${this.state.page}`,err_site:"get_page_data"};m.err_report(e)}}isReStart(e){let t=this.state.page||{page_name:"",end_time:0},r=Date.now()-t.end_time;return e&&e===t.page_name&&r>=d}reStart(){this.state.is_entry=1,this.state.req=n(this.state.cuid),this.state.data&&(this.state.data.req_id=this.state.req)}merge_datas(){return Object.assign(this.state.data||{},this.state.page||{},p)}handle_submit(t={}){let r=e(Object.assign({},this.merge_datas(),t));o(r).then(e=>{200==e.code?this.send_queue():this.save_to_queue(r)}).catch(e=>{this.save_to_queue(r)})}save_to_queue(e){let t=this.state.log_list&&this.state.log_list.length;return t&&t<50&&this.state.log_list.push(`${e}&retry=1`),this.state.log_list}send_queue(){let e=[...this.state.log_list];this.state.log_list=[],e.forEach(e=>{o(e).then(t=>{200!=t.code&&this.save_to_queue(e)}).catch(t=>{this.save_to_queue(e)})})}event_log(e={}){if(!this.state.req)return void console.error("event err:Please execute the “track_event” after the initialization is complete");let t=Object.assign({},e,{action:3});this.handle_submit(t)}err_report(e={}){if(this.state.data.svr)this.combine_err_data(Object.assign({},this.merge_datas(),e));else try{this.get_app_info((t={})=>{this.combine_err_data(Object.assign({},t,e))})}catch(e){}}combine_err_data(r={}){let i=Object.assign({action:9,err_time:(new Date).getTime(),err_id:""},r);var n;i.app_id=APP_CONFIG.app_key||"",u(f).then(r=>{let s=(new Date).getDate(),o={day:s,len:0};if(r)try{o=JSON.parse(r)}catch(e){}o.day!==s&&(o.len=0),o.len<50&&++o.len,o.len>50||(n=e(i),a.get({url:"/e.gif?"+n})).then(e=>{c(f,t(o)).then()})}).catch()}};const y={open_app(e){try{if(!APP_CONFIG.app_key)return void console.error("Not configured app_key!");m.init(e)}catch(e){let r={err_msg:t(e.stack)||"",err_site:"open_app"};m.err_report(r)}},page_show(e){try{m.page_stat(e)}catch(e){let r={err_msg:t(e.stack)||"",err_site:"page_show"};m.err_report(r)}},page_hide(e){try{l.has_init&&l.has_open_log&&m.page_end(e)}catch(e){let r={err_msg:t(e.stack)||"",err_site:"open_app"};m.err_report(r)}l.has_open_log=!1},track_event(e,r){try{if(!APP_CONFIG.app_key)return void console.error("Not configured app_key!");let i=void 0===r||null===r?"":r;if(!function(e){return"string"==typeof e&&""!==e&&/^[0-9a-zA-Z_\u4e00-\u9fa5]{1,255}$/.test(e)}(e))return void console.error('"event error": please check track_event id. id should be "string" and not null.');if(!s(i))return void console.error('"event error":  please check track_event parameter. parameter should be "string" or "object"');m.event_log({ev_id:e,ev_args:"string"==typeof i?i:t(i)})}catch(e){let r={err_msg:t(e.stack)||"",err_site:"track_event"};m.err_report(r)}},on_err(e){try{if(!APP_CONFIG.app_key)return void console.error("Not configured app_key!");let r={err_msg:t(e.stack)||"",err_site:"",action:8,err_id:md5(e.message.replace(/^[\S\s]+:/,""))};m.err_report(r)}catch(e){let r={err_msg:t(e.stack)||"",err_site:"on_err"};m.err_report(r)}}},v={app_sta_init:y.open_app,page_show:y.page_show,page_hide:y.page_hide,track_event:y.track_event,on_err:y.on_err},k=global.__proto__||global;return k.APP_STATISTICS=v,k.Custom_page=APP_STATISTICS.Custom_page=function(e){let t=e.onShow,r=e.onHide;return e.onShow=function(){y.page_show(this),t&&t.call(this)},e.onHide=function(){y.page_hide(this),r&&r.call(this)},e},v});